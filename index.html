<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>✨ Mayra Terrazas’ Tattoo Portfolio ✨</title>
  <meta name="description" content="Tattoo gallery for artist Mayra Terrazas — auto-loading gallery with click-to-zoom lightbox." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --pink-100:#fce7f3;
      --pink-400:#f472b6;
      --pink-600:#db2777;
      --periwinkle:#8F99FB;
      --ink:#1f2937;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans";
      color:var(--ink);
      /* top pink -> bottom periwinkle */
      background: linear-gradient(180deg, var(--pink-100) 0%, var(--periwinkle) 100%);
      min-height:100%;
    }

    header{
      position:sticky; top:0; z-index:40;
      backdrop-filter:saturate(140%) blur(8px);
      background:var(--pink-400);
      border-bottom:1px solid var(--pink-600);
      text-align:center;
      color:var(--periwinkle);
      padding:24px 20px;
      min-height:80px;
      display:flex; align-items:center; justify-content:center;
    }

    h1{margin:0; letter-spacing:.2px; font-size:clamp(1.25rem,2.6vw,2rem)}
    h1 strong{color:var(--periwinkle)}

    main{
      max-width:1200px; margin:0 auto; padding:20px;
      display:grid; grid-template-columns:repeat(auto-fill,minmax(250px,1fr)); gap:16px;
    }
    .thumb{
      width:100%; height:100%; aspect-ratio:4/5; object-fit:cover;
      border-radius:12px; border:2px solid rgba(255,255,255,.35);
      box-shadow:0 6px 14px rgba(0,0,0,.12); cursor:zoom-in; background:#fff;
    }

    /* Lightbox */
    .lightbox{position:fixed; inset:0; display:none; place-items:center; z-index:100;
      background:rgba(0,0,0,.4); backdrop-filter:blur(4px)}
    .lightbox.open{display:grid}
    .lightbox-inner{position:relative; width:min(96vw,1200px); height:min(92vh,900px);
      background:#0c0d10; border-radius:16px; overflow:hidden; border:2px solid rgba(255,255,255,.2);
      box-shadow:0 18px 50px rgba(0,0,0,.35)}
    .lb-topbar{position:absolute; left:0; right:0; top:0; height:48px; display:flex; align-items:center; justify-content:space-between; gap:8px;
      padding:8px 10px; background:linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,0)); color:#fff}
    .lb-controls{display:flex; gap:6px}
    .iconbtn{border:1px solid rgba(255,255,255,.35); background:rgba(255,255,255,.12); color:#fff; border-radius:10px; padding:8px 10px; cursor:pointer; font-weight:800}
    .iconbtn:hover{background:rgba(255,255,255,.2)}
    .viewer{position:absolute; inset:48px 0 0 0; background:#000; display:grid; place-items:center; cursor:grab}
    .viewer:active{cursor:grabbing}
    #full{transform-origin:0 0; user-select:none; -webkit-user-drag:none; will-change:transform}
  </style>
</head>
<body>
  <header>
    <h1>✨ <strong>Mayra Terrazas’</strong> Tattoo Portfolio ✨</h1>
  </header>

  <main id="gallery"></main>

  <!-- Build-time: enumerate all /images files (GitHub Pages / Jekyll only) -->
  {% assign imgs = site.static_files | where_exp: "f", "f.path contains '/images/'" %}
  <script>
    // Liquid populates this array on GitHub Pages:
    window.AUTO_SOURCES = [
      {% for f in imgs %}"{{ f.path | relative_url }}"{% unless forloop.last %}, {% endunless %}{% endfor %}
    ];
  </script>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" role="dialog" aria-modal="true" aria-labelledby="lbTitle">
    <div class="lightbox-inner">
      <div class="lb-topbar">
        <div class="lb-title" id="lbTitle">Scroll to zoom · drag to pan</div>
        <div class="lb-controls">
          <button class="iconbtn" id="zoomOut" aria-label="Zoom out">−</button>
          <button class="iconbtn" id="zoomIn" aria-label="Zoom in">+</button>
          <button class="iconbtn" id="zoomReset" aria-label="Reset zoom">100%</button>
          <button class="iconbtn" id="prev" aria-label="Previous">⟨</button>
          <button class="iconbtn" id="next" aria-label="Next">⟩</button>
          <button class="iconbtn" id="close" aria-label="Close">✕</button>
        </div>
      </div>
      <div class="viewer" id="viewer">
        <img id="full" alt="Expanded tattoo image" />
      </div>
    </div>
  </div>

  <script>
    // ====== Local fallback list (used when opening file locally) ======
    const imageFolder = 'images/';
    const fallbackList = [
      // Example fallback files for local testing (remove or change as you like)
      // 'tattoo1.jpg','tattoo2.jpg','tattoo3.jpg'
    ];

    const gallery = document.getElementById('gallery');

    // Use build-time list if available; otherwise fallback
    let sources = (window.AUTO_SOURCES && window.AUTO_SOURCES.length)
      ? window.AUTO_SOURCES
      : fallbackList.map(name => imageFolder + name);

    const imageList = sources.map(p => p.split('/').pop());

    // Create thumbnails
    sources.forEach((src, idx) => {
      const img = document.createElement('img');
      img.src = src;
      img.alt = imageList[idx] || 'Tattoo image';
      img.className = 'thumb';
      img.addEventListener('click', () => openLightbox(idx));
      gallery.appendChild(img);
    });

    // ====== Lightbox logic with zoom & pan ======
    const lightbox = document.getElementById('lightbox');
    const viewer = document.getElementById('viewer');
    const full = document.getElementById('full');
    const closeBtn = document.getElementById('close');
    const prevBtn = document.getElementById('prev');
    const nextBtn = document.getElementById('next');
    const zoomInBtn = document.getElementById('zoomIn');
    const zoomOutBtn = document.getElementById('zoomOut');
    const zoomResetBtn = document.getElementById('zoomReset');

    let currentIndex = 0;
    let scale = 1, originX = 0, originY = 0, lastX = 0, lastY = 0, isPanning = false;

    function setTransform(){
      full.style.transform = `translate(${originX}px, ${originY}px) scale(${scale})`;
    }

    function openLightbox(i){
      currentIndex = i;
      full.src = sources[currentIndex];
      full.alt = imageList[currentIndex] || 'Tattoo image';
      scale = 1; originX = 0; originY = 0; setTransform();
      lightbox.classList.add('open');
      document.body.style.overflow = 'hidden';
    }
    function closeLightbox(){
      lightbox.classList.remove('open');
      document.body.style.overflow = '';
    }

    function clamp(v,min,max){ return Math.min(max, Math.max(min,v)); }
    function zoomAt(clientX, clientY, delta){
      const rect = viewer.getBoundingClientRect();
      const offsetX = clientX - rect.left - originX;
      const offsetY = clientY - rect.top - originY;
      const prev = scale;
      scale = clamp(scale * (delta < 0 ? 1.1 : 0.9), 1, 8);
      const k = scale / prev - 1;
      originX -= offsetX * k; originY -= offsetY * k;
      setTransform();
    }

    // Wheel zoom
    viewer.addEventListener('wheel', (e) => { e.preventDefault(); zoomAt(e.clientX, e.clientY, e.deltaY); }, { passive:false });

    // Drag to pan
    viewer.addEventListener('pointerdown', (e) => { isPanning = true; lastX = e.clientX; lastY = e.clientY; viewer.setPointerCapture(e.pointerId); });
    viewer.addEventListener('pointermove', (e) => { if (!isPanning) return; originX += (e.clientX - lastX); originY += (e.clientY - lastY); lastX = e.clientX; lastY = e.clientY; setTransform(); });
    viewer.addEventListener('pointerup', () => { isPanning = false; });
    viewer.addEventListener('pointercancel', () => { isPanning = false; });

    // Touch: double-tap to zoom
    let lastTap = 0;
    viewer.addEventListener('touchend', (e) => {
      const now = Date.now();
      if (now - lastTap < 300) {
        const t = e.changedTouches[0];
        zoomAt(t.clientX, t.clientY, -1);
      }
      lastTap = now;
    });

    // Controls & keyboard
    closeBtn.addEventListener('click', closeLightbox);
    nextBtn.addEventListener('click', () => openLightbox((currentIndex + 1) % sources.length));
    prevBtn.addEventListener('click', () => openLightbox((currentIndex - 1 + sources.length) % sources.length));
    zoomInBtn.addEventListener('click', () => zoomAt(viewer.clientWidth/2, viewer.clientHeight/2, -1));
    zoomOutBtn.addEventListener('click', () => zoomAt(viewer.clientWidth/2, viewer.clientHeight/2, +1));
    zoomResetBtn.addEventListener('click', () => { scale = 1; originX = originY = 0; setTransform(); });

    window.addEventListener('keydown', (e) => {
      if (!lightbox.classList.contains('open')) return;
      if (e.key === 'Escape') closeLightbox();
      if (e.key === 'ArrowRight') nextBtn.click();
      if (e.key === 'ArrowLeft') prevBtn.click();
      if (e.key === '+') zoomInBtn.click();
      if (e.key === '-') zoomOutBtn.click();
      if (e.key === '0') zoomResetBtn.click();
    });

    // Click backdrop to close
    document.getElementById('lightbox').addEventListener('click', (e) => {
      if (e.target === lightbox) closeLightbox();
    });
  </script>
</body>
</html>
